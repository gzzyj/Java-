# ElasticSearch概览
## 基本概念和原理
### 索引结构
ElasticSearch是面向文档的，文档由`_index`， `_type`， `_id`唯一标识。`_index`指向一个或者多个物理分片的逻辑命名空间。 `_type`类型用于区分同一个集合中的不同细分，在不同细分中，数据的总体模式是相同或者相似的， 不适合完全不同类型的数据。`_id`文档标记符有系统自动生成或者使用者提供。
### 分片（shard）
分片是ElasticSearch底层基本读写单元，目的是为了分割巨大的索引，使读写可以并行操作，由多台机器共同完成。分片可以独立执行读写操作，读写请求最终会落到某个分片上，分片是数据的容器，文档保存在分片内，不会垮分片存储。分片又被分配到集群内各个节点里，当集群规模扩大或者缩小时，ES会自动在各个节点中迁移分片，使数据仍然均匀分布在集群里。<br>

ElasticSearch会把数据复制成多个副本，放置到不同的机器，提高可用性。ES将副本分成主从两个部分，即主分片（primary shard）和副分片（replica shard）。主数据作为权威数据，写过程中，先写主分片，主分片写成功后，同步到副分片。数据恢复时，以主分片为准。<br>

分片和索引的关系: <br>
一个ES索引包含很多分片，一个分片是一个Lucene索引。Lucene索引本身就是一个完整的搜索引擎，可以独立执行建立索引和搜索任务。<br>

在5.x版本之前，只有副分片数量可以修改，主分片数量不可以修改。 5.x-6.x版本，ES支持在一定限制下，对某个索引的主分片拆分（split）或 缩小（shrink）。但是依然需要在一开始就尽量规划好主分片数量。规划方法：分片数量 = （数据量 + 增长量）/ 单个分片容量。<br>

分片数不够时，可以考虑新建索引，或者使用`_split`API来拆分索引。 搜索一个拥有50个分片的索引和搜索50个每个都有一个分片的索引完全等价。 

### 动态更新索引
倒排索引一旦写入后，就具有不变性。 

### 近实时搜索
### 段合并
## 集群内部原理
### 集群节点角色
### 集群健康状态
### 集群状态
### 集群扩容
## 客户端API
## 主要内部模块简介
### 模块结构
### 模块管理
