# 缓存
缓存目的是为了减少获取请求数据需要的时间。在用户使用系统时，请求一般由客户端发出，逻辑上会按次序经过以下链路： 客户端 -> Proxy/Gateway-> 服务进程 -> 存储进程 -> 磁盘，数据可能会在某一层直接可以拿到，不需要再往下转发请求。 请求数据获取到之后，便会按照请求经过的链路，反向层层返回。 

* 客户端缓存：在客户端上保存服务器的数据副本，例如：HTTP 缓存、浏览器缓存等。

* Proxy/Gateway缓存：保存的是应用服务返回的数据，例如CDN、nginx反向代理服务或存等

* 应用层缓存：保存存储数据进程返回的数据，例如Memcached、Redis等键值存储

* 数据库缓存：保存内存中对磁盘数据的副本数据或先前计算过的查询，由数据库通过内置的缓存支持提供，比如查询缓存（query cache）

备注： HTTP协议的cache只是一个协议的一个字段，这种划分与通过HTTP协议接触的各个设施（客户端、Proxy/Gateway、应用服务）缓存的划分有交叉。 这里重点讨论的是应用层缓存。

## 基本概念

### 常见的驱逐策略
* LRU -- 当缓存数据达到缓存的上限，驱逐最久没有使用的
* FRU -- 当缓存数据达到缓存的上限，驱逐使用最少的
* TTL -- 根据给定的时间失效
* FIFO -- 当缓存数据达到缓存的上限，驱逐最早添加的
* RANDOM -- 随机驱逐

## 几种常见的缓存
* ehcache 
* Memcached 
* Redis 

### ehcache

特性： 
简单、轻量级；支持分布式；JVM缓存；提供Hibernate的实现；缓存落盘；监听器支持

原理：
支持分布式：通过广播实现。 
缓存落盘：通过DiskCache

优点： 
可以存储Java对象、分布式
支持分布式，缓存落盘不需要担心内存问题。

缺点： 
DiskCache格式存储简单，但可能会导致数据不安全。 
广播实现分布式导致ehcache在部署阶段不健壮。 


## 缓存的常见问题
缓存雪崩

缓存穿透


 
